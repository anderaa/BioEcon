theme(legend.position='bottom')
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(panel.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=1) +
theme(legend.position='bottom')
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(panel.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
quant0   <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'infective', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'infective', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, prevMax), expand = c(0, 0)) +
ylab('disease prevalence') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(panel.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
vaccMax <- max(resultsMatrix[, 'vaccinated', ]) * 1.1
daySeries <- seq(1, simulationEnd)
quant0   <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'vaccinated', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'vaccinated', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, vaccMax), expand = c(0, 0)) +
ylab('vaccinated dogs in population') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(panel.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
daySeries <- seq(1, simulationEnd)
prevMax <- max(resultsMatrix[, 'infective', ]) * 1.1
quant0   <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'infective', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'infective', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'infective', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, prevMax), expand = c(0, 0)) +
ylab('disease prevalence') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(panel.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, prevMax), expand = c(0, 0)) +
ylab('disease prevalence') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(solid.background = element_rect(fill = 'white', colour = 'black')) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
########################################################################################################################
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, prevMax), expand = c(0, 0)) +
ylab('disease prevalence') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, prevMax), expand = c(0, 0)) +
ylab('disease prevalence') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
theme(plot.background=element_rect(fill="grey")) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
#####################################
abunMax <- max(resultsMatrix[, 'abundance', ]) * 1.1
daySeries <- seq(1, simulationEnd)
quant0   <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'abundance', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
abunMax <- max(resultsMatrix[, 'abundance', ]) * 1.1
daySeries <- seq(1, simulationEnd)
quant0   <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'abundance', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour='black'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_line(colour='black'),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour='black'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour='black'),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
abunMax <- max(resultsMatrix[, 'abundance', ]) * 1.1
daySeries <- seq(1, simulationEnd)
quant0   <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'abundance', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_line(colour='black'),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour='black'),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
############################################
abunMax <- max(resultsMatrix[, 'abundance', ]) * 1.1
daySeries <- seq(1, simulationEnd)
quant0   <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.0)
quant10  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.1)
quant20  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.2)
quant30  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.3)
quant40  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.4)
quant50  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.5)
quant60  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.6)
quant70  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.7)
quant80  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.8)
quant90  <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 0.9)
quant100 <- apply(resultsMatrix[, 'abundance', ], 1, quantile, 1.0)
mean = apply(resultsMatrix[, 'abundance', ], 1, mean, na.rm=TRUE)
plot_df = data.frame(cbind(quant0, quant10, quant20, quant30, quant40, quant50,
quant60, quant70, quant80, quant90, quant100, mean))
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour='black'),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
###########################################
ggplot() +
geom_ribbon(aes(x=daySeries, ymax=quant100, ymin=quant0, fill='full range  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant90, ymin=quant10, fill='percentile 10 to 90  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant80, ymin=quant20, fill='percentile 20 to 80  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant70, ymin=quant30, fill='percentile 30 to 70  ')) +
geom_ribbon(aes(x=daySeries, ymax=quant60, ymin=quant40, fill='percentile 40 to 60  ')) +
geom_line(aes(daySeries, plot_df$quant50, colour = 'median  ')) +
geom_line(aes(daySeries, plot_df$mean, colour = 'mean  '), size=1.0) +
scale_x_continuous(limits=c(0, simulationEnd), expand = c(0, 25), breaks=c(365, 730, 1095, 1460, 1825),
labels = c('1', '2', '3', '4', '5')) +
scale_y_continuous(limits=c(0, abunMax), expand = c(0, 0)) +
ylab('abundance') +
theme(axis.title.y=element_text(margin=margin(0,10,0,0))) +
theme(axis.text=element_text(size=12, color='black'),
axis.title=element_text(size=14, face="bold", color='black')) +
xlab('year') +
theme(axis.line = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(fill=NA, colour='black'),
panel.background = element_blank()) +
scale_colour_manual(name=NULL, values=c('median  '='#1B4F72',
'mean  '='black')) +
scale_fill_manual(name=NULL, values=c('full range  '='#5DADE2',
'percentile 10 to 90  '='#3498DB',
'percentile 20 to 80  '='#2E86C1',
'percentile 30 to 70  '='#2874A6',
'percentile 40 to 60  '='#21618C')) +
theme(legend.text.align=0) +
theme(legend.position='bottom')
